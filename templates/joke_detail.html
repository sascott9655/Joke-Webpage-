<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Joke Details</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/index.css') }}">
    <script src="{{ url_for('static', filename='js/joke_detail.js') }}"></script>
</head>
<body>
    <a href="{{ url_for('index') }}">&larr; Back to all jokes</a>
        <hr>

        <h2>Joke Details</h2>
        <p><strong>Author:</strong> {{ joke.username }}</p>
        <p><strong>Joke:</strong> {{ joke.content }}</p>
        <p><strong>Rating:</strong> {{ joke.rating or 0 }}/5</p>
        <hr>

    <button class="comment-section-button" type="submit">Show Comments â†“</button>
    <hr>
    <div class="comment-section-wrapper" style="display:None;">
    {% if comments %}
        {% for comment in comments %}
            <div class="comment-section">
                <strong>{{ comment.username }}</strong> {{ comment.rating }}/5<em> {{ comment.comment }} </em> 
                <small>{{ comment.timestamp }}</small><br>
            </div>
            <br>
            <hr>
        {% endfor %}
    {% else %}
            <p>No comments yet!</p>
    {% endif %}
    </div>

    {% if session.get('user_id') %}
            <form method ="POST" action="{{ url_for('rate_joke', joke_id = joke['id'])}}">
                <label for="rating">Rate this joke:</label>
                <select name="rating" required>
                    <option value=""> </option>
                    {% for i in range(1, 6) %}
                    <option value="{{ i }}">{{ i }}</option>
                    {% endfor %}
                </select>
                <label for="comment">Comment:</label>
                <textarea name="comment" required></textarea>
                <button type="submit">Submit</button>
            </form>
    {% else %}
        Please <a href="{{ url_for('login') }}">sign in</a> to comment!
    {% endif %}
     <footer>
        <hr>
        <p>&copy; 2025 Joke Hub - Created by Sam Scott </p>
    </footer>
</body>
</html>